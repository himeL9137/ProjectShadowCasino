In the current version of the Shadow Casino Admin Dashboard, there is a critical flaw in the way user activity status is reported. Specifically, the admin panel incorrectly displays every user account — including newly registered users, long-standing inactive users, administrators, testers, and even suspended or bot accounts — as “Active,” regardless of their actual login state. This leads to inaccurate analytics, poor administrative decision-making, and confusion about real platform activity. A user should only be considered "Active" if they currently have an open, valid, and authenticated session. If the user is not logged in or has timed out or disconnected, they must be shown as “Inactive.” The goal of this prompt is to fix the user status logic both in the backend and frontend of the admin panel so that it accurately reflects whether a user is currently logged in or not. This includes implementing session tracking, updating the database schema, modifying the API endpoints, and enhancing the admin panel UI to display this information clearly.

To begin, the backend system must include a reliable session tracking mechanism. Whether your application uses JWTs, server-side sessions, or socket-based connections, you need a way to identify and persist a user’s login state. A lastSeen field of type DateTime should be introduced (if not already available) in your users table to log the exact timestamp of the user’s most recent activity. Additionally, a boolean flag such as isOnline should be added and updated in real time. This isOnline field will be set to true when the user logs in or has an active session and reset to false when they log out, close the browser, or get disconnected. You can manage this status using WebSocket connection events, session token validation, or a heartbeat ping interval (e.g., every 60 seconds). For real-time presence updates, Redis or an in-memory store like Node-cache or socket.io-presence can be used to handle large volumes of concurrent user connections without putting unnecessary load on the database.

On the server side, every successful login should trigger an update to the lastSeen field with the current timestamp and set isOnline to true. Conversely, logout actions, session expirations, or WebSocket disconnect events must set isOnline to false. If using JWTs without session state, you can still estimate online status by tracking recent authenticated actions and updating the lastSeen field accordingly. Middleware that wraps around route handlers (e.g., Express middleware for protected endpoints) can be used to auto-update lastSeen and optionally mark users as isOnline during interaction windows. You may also implement automatic offline status after a certain period of inactivity, such as setting isOnline to false if lastSeen is older than 5 minutes.

Next, the admin panel frontend must reflect these updates. In the user list or dashboard summary where users are shown, a new column labeled “Status” should be added. Each user should have a clearly marked status indicator — either “Active” or “Inactive” — based on the real-time or recent isOnline flag. For better UI/UX, use a color-coded badge (e.g., green for Active, gray for Inactive) or small icons to visually distinguish the states. Here’s a small JSX example for rendering status: <span className={isOnline ? 'bg-green-500 text-white' : 'bg-gray-400 text-white'}> {isOnline ? 'Active' : 'Inactive'} </span>. If you want to be more precise or informative, include a tooltip on hover that shows the exact last seen time, such as “Last seen: 2 minutes ago.” This gives the admin a clearer picture of user engagement.

To support the frontend, the backend must expose this user status data through an appropriate API. Either update the existing /admin/users endpoint or create a new endpoint like /admin/user-status, which returns a list of users along with their email, role, lastSeen, and isOnline values. A sample response would look like:

json
Copy
Edit
[{  
  "id": "user123",  
  "email": "user@example.com",  
  "role": "user",  
  "lastSeen": "2025-07-03T09:15:00Z",  
  "isOnline": true  
}]  
This allows the frontend to render a fully updated and accurate status table. Additionally, the dashboard should either support live polling (e.g., fetch this endpoint every 60 seconds) or provide a manual “Refresh” button to get the latest user status snapshot. WebSocket integration can also be used if you prefer push-based updates.

To ensure the entire system works reliably, thorough testing must be conducted. On the backend, write unit and integration tests that simulate login and logout events and confirm that the isOnline flag and lastSeen fields are updated properly. Test session expirations and disconnect scenarios to confirm that users are correctly marked offline after inactivity. On the frontend, run UI tests that simulate user entries with different status states and ensure badges or indicators display correctly. Also validate that the refresh logic works properly and doesn’t cause API spam or lag.

For newly registered users, make sure they are shown as “Inactive” by default until they log in for the first time. For users who were once active but haven't logged in for a long time, isOnline should be false and their lastSeen should display how long ago they were last seen (e.g., “3 days ago”). Admin accounts should also follow the same logic — no special privileges or hardcoded values for their status display.

From a security standpoint, make sure the lastSeen and isOnline values are only accessible to admin or superadmin users. Regular users should never be able to query this data. Rate limit the /admin/users or /admin/user-status endpoint to prevent abuse, and avoid spamming the database on every single ping. If you're using a cache or socket tracking system, ensure it has proper cleanup for stale connections.

The fix must work seamlessly with all other features in your system, including rigged games, wallet systems, admin roles, and multi-currency support. The UI should remain responsive and performant even with hundreds or thousands of users. After deployment, monitor the dashboard for anomalies, test with real user traffic, and verify the system does not falsely label users as online or offline.

In conclusion, this update is essential for maintaining a trustworthy, transparent, and admin-friendly platform. The accurate representation of user activity directly supports operational monitoring, fraud detection, performance analysis, and business intelligence. Once implemented, admins will gain real insight into who is actually active, which users are dormant, and when peak traffic occurs. This allows for smarter management and better scaling decisions. Please implement all described changes thoroughly and test across all roles, devices, and network conditions to ensure stability and accuracy across your Shadow Casino platform.

